        /// <summary>
                 /// Tạo DataTable cho LN03 với đúng column types (20 business columns)
                 /// </summary>
        private void CreateLN03DataTable(DataTable dataTable, string[]? headers)
        {
            // CSV Business columns 1-17 (có header)
            dataTable.Columns.Add("MACHINHANH", typeof(string));
            dataTable.Columns.Add("TENCHINHANH", typeof(string));
            dataTable.Columns.Add("MAKH", typeof(string));
            dataTable.Columns.Add("TENKH", typeof(string));
            dataTable.Columns.Add("SOHOPDONG", typeof(string));
            dataTable.Columns.Add("SOTIENXLRR", typeof(decimal));
            dataTable.Columns.Add("NGAYPHATSINHXL", typeof(string));  // Keep as string for date parsing
            dataTable.Columns.Add("THUNOSAUXL", typeof(decimal));
            dataTable.Columns.Add("CONLAINGOAIBANG", typeof(decimal));
            dataTable.Columns.Add("DUNONOIBANG", typeof(decimal));
            dataTable.Columns.Add("NHOMNO", typeof(string));  // Changed to string
            dataTable.Columns.Add("MACBTD", typeof(string));
            dataTable.Columns.Add("TENCBTD", typeof(string));
            dataTable.Columns.Add("MAPGD", typeof(string));
            dataTable.Columns.Add("TAIKHOANHACHTOAN", typeof(string));
            dataTable.Columns.Add("REFNO", typeof(string));
            dataTable.Columns.Add("LOAINGUONVON", typeof(string));

            // CSV columns 18-20 (không có header trong file)
            dataTable.Columns.Add("MALOAI", typeof(string));           // Column 18: "100"
            dataTable.Columns.Add("LOAIKHACHHANG", typeof(string));    // Column 19: "Cá nhân"
            dataTable.Columns.Add("HANMUCPHEDUYET", typeof(decimal));  // Column 20: số tiền

            // System columns
            dataTable.Columns.Add("Id", typeof(long));
            dataTable.Columns.Add("NGAY_DL", typeof(DateTime));
            dataTable.Columns.Add("CreatedAt", typeof(DateTime));
            dataTable.Columns.Add("UpdatedAt", typeof(DateTime));
            dataTable.Columns.Add("ImportId", typeof(int));
        }
