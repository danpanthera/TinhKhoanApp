<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ Viewport Positioning Test</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 300vh; /* Long page ƒë·ªÉ test scroll */
        }
        
        .debug-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 5000;
        }
        
        .content {
            padding: 50px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .section {
            background: white;
            margin: 50px 0;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .test-btn {
            background: #8B1538;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
        }
        
        .test-btn:hover {
            background: #A91B47;
        }
        
        /* Modal styles - copy t·ª´ Vue app */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.75);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(2px);
        }
        
        .modal-overlay.show {
            display: flex;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            position: relative;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
        }
        
        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
        }
        
        .form-section {
            margin: 100px 0;
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            border: 2px dashed #8B1538;
        }
    </style>
</head>
<body>
    <!-- Debug Panel -->
    <div class="debug-panel" id="debugPanel">
        <div>Scroll Y: <span id="scrollY">0</span>px</div>
        <div>Viewport H: <span id="viewportH">0</span>px</div>
        <div>Modal Top: <span id="modalTop">0</span>px</div>
        <div>Transform Y: <span id="transformY">0</span>px</div>
    </div>
    
    <div class="content">
        <div class="section">
            <h1>üß™ Modal Positioning Test Page</h1>
            <p>Trang n√†y test modal positioning gi·ªëng nh∆∞ trong Vue app th·ª±c t·∫ø.</p>
            <button class="test-btn" onclick="scrollToForm()">üìç Scroll to Form (Bottom)</button>
            <button class="test-btn" onclick="scrollToTop()">‚¨ÜÔ∏è Scroll to Top</button>
        </div>
        
        <div class="section">
            <h2>üìù Section 1</h2>
            <p>Content gi·ªØa ƒë·ªÉ t·∫°o scroll d√†i...</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
        </div>
        
        <div class="section">
            <h2>üìä Section 2</h2>
            <p>Th√™m content ƒë·ªÉ scroll xu·ªëng...</p>
            <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
        </div>
        
        <div class="section">
            <h2>üìà Section 3</h2>
            <p>Continue scrolling...</p>
            <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
        </div>
        
        <!-- FORM SECTION - ·ªû cu·ªëi trang nh∆∞ trong Vue app -->
        <div class="form-section" id="formSection">
            <h2>üìù Form Ch·ªânh S·ª≠a KPI (·ªû CU·ªêI TRANG)</h2>
            <p><strong>üéØ ƒê√¢y l√† n∆°i form KPI berada trong app th·ª±c t·∫ø!</strong></p>
            <p>Khi user click n√∫t "‚úèÔ∏è S·ª≠a", modal ph·∫£i xu·∫•t hi·ªán <strong>T·∫†I ƒê√ÇY</strong> - kh√¥ng ph·∫£i ·ªü ƒë·∫ßu trang!</p>
            
            <!-- Test Modal Buttons -->
            <button class="test-btn" onclick="testModalPositioning('transform')">
                üß™ Test Transform Approach
            </button>
            <button class="test-btn" onclick="testModalPositioning('absolute')">
                üß™ Test Absolute Approach
            </button>
            <button class="test-btn" onclick="testModalPositioning('fixed')">
                üß™ Test Fixed Approach
            </button>
            
            <div style="margin-top: 20px; padding: 15px; background: rgba(139, 21, 56, 0.1); border-radius: 5px;">
                <h4>‚úÖ Expected Result:</h4>
                <ul>
                    <li>‚úÖ Modal xu·∫•t hi·ªán T·∫†I v·ªã tr√≠ n√†y (cu·ªëi trang)</li>
                    <li>‚úÖ Kh√¥ng c·∫ßn scroll l√™n ƒë·ªÉ th·∫•y modal</li>
                    <li>‚úÖ Modal center horizontally nh∆∞ng ·ªü current viewport</li>
                </ul>
            </div>
        </div>
        
        <div class="section">
            <h2>üéØ End of Page</h2>
            <p>ƒê√¢y l√† cu·ªëi trang. Modal ph·∫£i xu·∫•t hi·ªán ·ªü form section ph√≠a tr√™n.</p>
        </div>
    </div>
    
    <!-- Modal -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <button class="close-btn" onclick="closeModal()">‚úï</button>
            <h3>üéØ Test Modal - Positioning Check</h3>
            <p>Modal n√†y ph·∫£i xu·∫•t hi·ªán t·∫°i v·ªã tr√≠ form (cu·ªëi trang), kh√¥ng ph·∫£i ·ªü ƒë·∫ßu trang!</p>
            
            <div style="background: #e8f5e8; padding: 15px; border-radius: 5px; margin: 15px 0;">
                <strong>‚úÖ SUCCESS!</strong> N·∫øu anh th·∫•y modal n√†y m√† kh√¥ng c·∫ßn scroll, nghƒ©a l√† positioning ƒë√£ work!
            </div>
            
            <div>
                <label>Test Input:</label><br>
                <input type="text" placeholder="Nh·∫≠p test value..." style="width: 100%; padding: 8px; margin: 5px 0;">
            </div>
            
            <div style="margin-top: 20px;">
                <button onclick="closeModal()" style="background: #6c757d; color: white; padding: 8px 16px; border: none; border-radius: 4px; margin-right: 10px;">H·ªßy</button>
                <button onclick="closeModal()" style="background: #8B1538; color: white; padding: 8px 16px; border: none; border-radius: 4px;">OK</button>
            </div>
        </div>
    </div>
    
    <script>
        let currentApproach = '';
        
        // Update debug info
        function updateDebugInfo() {
            const scrollY = window.scrollY;
            const viewportHeight = window.innerHeight;
            
            document.getElementById('scrollY').textContent = Math.round(scrollY);
            document.getElementById('viewportH').textContent = viewportHeight;
        }
        
        function scrollToForm() {
            document.getElementById('formSection').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function testModalPositioning(approach) {
            currentApproach = approach;
            const modalOverlay = document.getElementById('modalOverlay');
            const currentScrollY = window.scrollY;
            const viewportHeight = window.innerHeight;
            
            console.log('üß™ Testing approach:', approach, 'Scroll:', currentScrollY);
            
            // Reset styles first
            modalOverlay.style.cssText = '';
            
            if (approach === 'transform') {
                // Transform approach - gi·ªëng nh∆∞ em v·ª´a code
                const modalTopOffset = Math.max(50, viewportHeight * 0.2);
                modalOverlay.style.cssText = `
                    position: fixed !important;
                    top: 0 !important;
                    left: 0 !important;
                    right: 0 !important;
                    bottom: 0 !important;
                    width: 100vw !important;
                    height: 100vh !important;
                    background: rgba(0, 0, 0, 0.75) !important;
                    display: flex !important;
                    justify-content: center !important;
                    align-items: flex-start !important;
                    padding: 20px !important;
                    padding-top: ${modalTopOffset}px !important;
                    z-index: 10000 !important;
                    transform: translateY(${currentScrollY}px) !important;
                `;
                document.getElementById('transformY').textContent = currentScrollY;
                document.getElementById('modalTop').textContent = 'Transform: ' + currentScrollY;
                
            } else if (approach === 'absolute') {
                // Absolute approach
                const modalTop = currentScrollY + (viewportHeight * 0.2);
                modalOverlay.style.cssText = `
                    position: absolute !important;
                    top: ${modalTop}px !important;
                    left: 0 !important;
                    right: 0 !important;
                    background: rgba(0, 0, 0, 0.75) !important;
                    display: flex !important;
                    justify-content: center !important;
                    align-items: flex-start !important;
                    padding: 20px !important;
                    padding-top: 50px !important;
                    z-index: 10000 !important;
                    min-height: 100vh !important;
                `;
                document.getElementById('modalTop').textContent = modalTop;
                
            } else if (approach === 'fixed') {
                // Fixed v·ªõi margin-top
                const marginTop = viewportHeight * 0.2;
                modalOverlay.style.cssText = `
                    position: fixed !important;
                    top: 0 !important;
                    left: 0 !important;
                    right: 0 !important;
                    bottom: 0 !important;
                    background: rgba(0, 0, 0, 0.75) !important;
                    display: flex !important;
                    justify-content: center !important;
                    align-items: flex-start !important;
                    padding: 20px !important;
                    padding-top: ${marginTop}px !important;
                    z-index: 10000 !important;
                `;
                document.getElementById('modalTop').textContent = 'Fixed: ' + marginTop;
            }
            
            modalOverlay.classList.add('show');
        }
        
        function closeModal() {
            const modalOverlay = document.getElementById('modalOverlay');
            modalOverlay.classList.remove('show');
            modalOverlay.style.cssText = '';
        }
        
        // Event listeners
        window.addEventListener('scroll', updateDebugInfo);
        window.addEventListener('resize', updateDebugInfo);
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeModal();
            if (e.key === 'f' || e.key === 'F') scrollToForm();
            if (e.key === 't' || e.key === 'T') testModalPositioning('transform');
            if (e.key === 'a' || e.key === 'A') testModalPositioning('absolute');
        });
        
        // Initial update
        updateDebugInfo();
        
        console.log('üß™ Test page loaded! Shortcuts: F=scroll to form, T=transform test, A=absolute test, Esc=close');
    </script>
</body>
</html>
